TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>%
add_overall()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>% as_kable()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>% as_gt()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>% as_word()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>% gt::as_word()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>% as_gt %>% gt::as_word()
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode, Group_Ident_Degree, Group_Ident_TU) %>%
tbl_summary() %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary.docx")
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary() %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary.docx")
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary() %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary.docx")
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary() %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary.docx")
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary() %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary1.docx")
TUSI_genderfixed %>%
select(Group_Ident_TU, Group_Ident_Course, Group_Ident_Degree, ABC_Revised_17, PERMA_sum) %>%
tbl_summary() %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary2.docx")
TUSI_genderfixed %>%
select(Group_Ident_TU, Group_Ident_Course, Group_Ident_Degree, ABC_Revised_17, PERMA_sum) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary2.docx")
TUSI_genderfixed %>%
select(Group_Ident_TU, Group_Ident_Course, Group_Ident_Degree, ABC_Revised_17, PERMA_sum) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary2.docx")
TUSI_genderfixed %>%
select(Group_Ident_TU, Group_Ident_Course, Group_Ident_Degree, ABC_Revised_17, PERMA_sum) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary2.docx")
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} / {N} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary1.docx")
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary1.docx")
summary(step.model_degree)
step.model_degree <- stepAIC(full_model_degree, direction = "both", trace = TRUE)
library(MASS)
full_model_TU <- lm(data=TUSI_genderfixed, Group_Ident_TU ~ Age * Sex * SexOrientation * Ethnicity * Study_Level * PT_Job * dependents_overall )
step.model_TU <- stepAIC(full_model_TU, direction = "both", trace = TRUE)
step.model_TU <- stepAIC(full_model_TU, direction = "both", trace = TRUE)
summary(step.model_TU)
gt::gt(step.model_TU)
gtsummary::tbl_regression(step.model_TU)
summary(step.model_degree) %>% as_gt() %>% gt::gtsave("regression1.docx")
gtsummary::tbl_regression(step.model_degree) %>% as_gt() %>% gt::gtsave("regression1.docx")
gtsummary::tbl_regression(step.model_TU) %>% as_gt() %>% gt::gtsave("regression1.docx")
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
as_gt() %>%
gt::gtsave("regression1.docx")
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
as_gt() %>%
gt::gtsave("regression1.docx")
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
as_gt() %>%
gt::gtsave("step_regression_TU.docx")
emmeans::emmeans(step.model_TU, ~ Sex | Study_Level)
emmeans::emmeans(step.model_TU, ~ Study_Level | Sex)
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Study_Level | Sex)
pairs(em_mod1)
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Study_Level * Sex)
pairs(em_mod1)
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
add_global_p()
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
add_global_p()
#load in data from SPSS using haven
library(dplyr)
TUSI_results_subscales <- haven::read_sav("TUSI_recoded.sav")
# data formatting
TUSI_results_subscales$Study_Mode <- as.factor(TUSI_results_subscales$Study_Mode)
TUSI_results_subscales$Study_Level <- as.factor(TUSI_results_subscales$Study_Level)
TUSI_results_subscales$Degree <- as.factor(TUSI_results_subscales$Degree)
TUSI_results_subscales$Ethnicity <- as.factor(TUSI_results_subscales$Ethnicity)
TUSI_results_subscales$SexOrientation <- as.factor(TUSI_results_subscales$SexOrientation)
TUSI_results_subscales$Sex <- as.factor(TUSI_results_subscales$Sex)
TUSI_results_subscales$PT_Job <- as.factor(TUSI_results_subscales$PT_Job)
TUSI_results_subscales$Depend17Under <- as.factor(TUSI_results_subscales$Depend17Under)
TUSI_results_subscales$Depend18Over <- as.factor(TUSI_results_subscales$Depend18Over)
# make a new column for for dependents_overall if participants have any dependents in either Depend17Under or Depend18Over
TUSI_results_subscales <-  TUSI_results_subscales %>% mutate(dependents_overall = ifelse(Depend17Under == 0 | Depend18Over == 0, 0, 1) )
# regression model demographics
TUSI_genderfixed <- TUSI_results_subscales %>% filter(Sex == "1" | Sex == "2" )
# some descriptive statistics
# i want counts of sex, ethnicity, sexual orientation, and age
TUSI_genderfixed %>%
summary()
library(gtsummary)
library(tidyverse)
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary1.docx")
library(MASS)
#tu identity
full_model_TU <- lm(data=TUSI_genderfixed, Group_Ident_TU ~ Age * Sex * SexOrientation * Ethnicity * Study_Level * PT_Job * dependents_overall )
step.model_TU <- stepAIC(full_model_TU, direction = "both", trace = TRUE)
summary(step.model_TU)
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
add_global_p() %>%
as_gt() %>%
gt::gtsave("step_regression_TU.docx")
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note()
View(step.model_TU)
test <- lm(data=TUSI_genderfixed, Group_Ident_Degree ~ Age * Sex * SexOrientation * Ethnicity * Study_Level * PT_Job * dependents_overall )
summary(test)
gtsummary::tbl_regression(test)
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Study_Level * PT_Job)
pairs(em_mod1)
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Study_Level | PT_Job)
pairs(em_mod1)
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Age * Study_Level | PT_Job)
pairs(em_mod1)
gtsummary::tbl_regression(step.model_degree) %>%
add_glance_source_note() %>%
as_gt() %>%
gt::gtsave("step_regression_degree.docx")
full_model_degree <- lm(data=TUSI_genderfixed, Group_Ident_Degree ~ Age * Sex * SexOrientation * Ethnicity * Study_Level * PT_Job * dependents_overall )
step.model_degree <- stepAIC(full_model_degree, direction = "both", trace = TRUE)
step.model_degree <- stepAIC(full_model_degree, direction = "backward", trace = FALSE)
step.model_TU <- stepAIC(full_model_TU, direction = "backward", trace = FALSE)
summary(step.model_TU)
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
as_gt() %>%
gt::gtsave("step_regression_TU.docx")
gtsummary::tbl_regression(step.model_TU) %>%
add_glance_source_note() %>%
as_gt() %>%
gt::gtsave("step_regression_TU.docx")
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Age * Study_Level | PT_Job | dependents_overall)
pairs(em_mod1)
em_mod1 <- emmeans::emmeans(step.model_TU, ~ Age | Study_Level | PT_Job | dependents_overall)
pairs(em_mod1)
em_mod1 <- emmeans::emmeans(step.model_TU, ~  Study_Level | PT_Job | dependents_overall * Age)
pairs(em_mod1)
#load in data from SPSS using haven
library(dplyr)
TUSI_results_subscales <- haven::read_sav("TUSI_recoded.sav")
# data formatting
TUSI_results_subscales$Study_Mode <- as.factor(TUSI_results_subscales$Study_Mode)
TUSI_results_subscales$Study_Level <- as.factor(TUSI_results_subscales$Study_Level)
TUSI_results_subscales$Degree <- as.factor(TUSI_results_subscales$Degree)
TUSI_results_subscales$Ethnicity <- as.factor(TUSI_results_subscales$Ethnicity)
TUSI_results_subscales$SexOrientation <- as.factor(TUSI_results_subscales$SexOrientation)
TUSI_results_subscales$Sex <- as.factor(TUSI_results_subscales$Sex)
TUSI_results_subscales$PT_Job <- as.factor(TUSI_results_subscales$PT_Job)
TUSI_results_subscales$Depend17Under <- as.factor(TUSI_results_subscales$Depend17Under)
TUSI_results_subscales$Depend18Over <- as.factor(TUSI_results_subscales$Depend18Over)
# make a new column for for dependents_overall if participants have any dependents in either Depend17Under or Depend18Over
TUSI_results_subscales <-  TUSI_results_subscales %>% mutate(dependents_overall = ifelse(Depend17Under == 0 | Depend18Over == 0, 0, 1) )
# regression model demographics
TUSI_genderfixed <- TUSI_results_subscales %>% filter(Sex == "1" | Sex == "2" )
# some descriptive statistics
# i want counts of sex, ethnicity, sexual orientation, and age
TUSI_genderfixed %>%
summary()
library(gtsummary)
library(tidyverse)
TUSI_genderfixed %>%
select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
tbl_summary(statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"
)) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary1.docx")
#load in data from SPSS using haven
library(dplyr)
TUSI_results_subscales <- haven::read_sav("TUSI_recoded.sav")
# data formatting
TUSI_results_subscales$Study_Mode <- as.factor(TUSI_results_subscales$Study_Mode)
TUSI_results_subscales$Study_Level <- as.factor(TUSI_results_subscales$Study_Level)
TUSI_results_subscales$Degree <- as.factor(TUSI_results_subscales$Degree)
TUSI_results_subscales$Ethnicity <- as.factor(TUSI_results_subscales$Ethnicity)
TUSI_results_subscales$SexOrientation <- as.factor(TUSI_results_subscales$SexOrientation)
TUSI_results_subscales$Sex <- as.factor(TUSI_results_subscales$Sex)
TUSI_results_subscales$PT_Job <- as.factor(TUSI_results_subscales$PT_Job)
TUSI_results_subscales$Depend17Under <- as.factor(TUSI_results_subscales$Depend17Under)
TUSI_results_subscales$Depend18Over <- as.factor(TUSI_results_subscales$Depend18Over)
# make a new column for for dependents_overall if participants have any dependents in either Depend17Under or Depend18Over
TUSI_results_subscales <-  TUSI_results_subscales %>% mutate(dependents_overall = ifelse(Depend17Under == 0 | Depend18Over == 0, 0, 1) )
# regression model demographics
TUSI_genderfixed <- TUSI_results_subscales %>% filter(Sex == "1" | Sex == "2" )
# some descriptive statistics
# i want counts of sex, ethnicity, sexual orientation, and age
TUSI_genderfixed %>%
summary()
library(gtsummary)
library(tidyverse)
#TUSI_genderfixed %>%
#  select(Age, Sex, SexOrientation, Ethnicity, PT_Job, dependents_overall, Study_Level, Degree, Study_Mode) %>%
# tbl_summary(statistic = list(
#      all_continuous() ~ "{mean} ({sd})",
#      all_categorical() ~ "{n} ({p}%)"
#    )) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary1.docx")
## results summary
# TUSI_genderfixed %>%
#  select(Group_Ident_TU, Group_Ident_Course, Group_Ident_Degree, ABC_Revised_17, PERMA_sum) %>%
#  tbl_summary(statistic = list(
#      all_continuous() ~ "{mean} ({sd})",
#      all_categorical() ~ "{n} / {N} ({p}%)"
#    )) %>% as_gt %>% gt::gtsave("TUSI_genderfixed_summary2.docx")
TUSI_genderfixed$age %>% min()
TUSI_genderfixed %>%
na.omit() %>%
min(age)
#### Experiment 3: Repeated measure design with 20 trials
nparticipants = 26
ntrials = 20
beta_gamble = 0.5
beta_gamble1 = 0.2
beta_gamble2 = -0.3
beta_gamble3 = -0.3
beta_expectedValue = 0.1
## There should be nparticipants number of participants. Each participant is randomly assigned to one of the conditions. Each participant completes 10 trials: 2 of each expected value.
# Create a data frame with the data
simulate_power <- function(iter, nparticipants = 26, ntrials = 20, beta_gamble =0.5, beta_gamble1 = 0.3, beta_gamble2 = -0.3, beta_gamble3 = -0.3, beta_expectedValue=0.1) {
##set.seed(123)
# in this experiment, there are 3 conditions. However, each participant is in all conditions. there are 20 trials per participant. 4 of each expected value.
# pid is the participant id. There are nparticipants number of participants.
pid = rep(1:nparticipants, each=ntrials*3)
condition = rep(c("1", "2", "3"), nparticipants)
condition = rep(condition, each=ntrials)
expected_value = rep(c(0, 2.5, 5, 7.5, 10), 4)
expected_value = rep(expected_value, 3)
expected_value = rep(expected_value, nparticipants)
data = data.frame(pid, expected_value, condition)
# the probability of choosing the gamble is 0.5 for participants by default.  However, previous research has shown that the other conditions decrease the likelihood of choosing the gamble by 0.1.
data$gamble = beta_gamble
data$beta_gamble_cond1 = beta_gamble1
data$beta_gamble_cond2 = beta_gamble2
data$beta_gamble_cond3 = beta_gamble3
# Expected value is an ordinal variable. We can assume that the effect of expected value is linear. The probability of choosing the gamble increases by 0.1 for each unit increase in expected value.
data$beta_gamble_expected_value = beta_expectedValue
# Since the model is a logistic mixed effects model, we need to simulate random effects for each participant. Based on the random slope (1|pid) We will assume that the random effect for each participant is normally distributed with a mean of 0 and a standard deviation of 0.1.
random_effect = rnorm(nparticipants, 0, 0.1)
data$random_effect = rep(random_effect, each=ntrials*3)
# Now we can simulate the outcome variable. We will use the logistic function to calculate the probability of choosing the gamble for each trial.
data$prob_gamble = 1/(data$gamble+exp(-(data$beta_gamble_cond1*(data$condition=="1") + data$beta_gamble_cond2*(data$condition=="2") + data$beta_gamble_cond3*(data$condition=="3") + data$beta_gamble_expected_value*data$expected_value + data$random_effect)))
# now we can simulate the outcome variable. We will use the logistic function to calculate the probability of choosing the gamble for each trial.
data$gamble = rbinom(nrow(data), 1, data$prob_gamble)
# expected value is an ordinal variable.
data$expected_value = as.factor(data$expected_value)
# Now we can fit the logistic mixed effects model to the data
library(lme4)
model = glmer(gamble ~ condition + expected_value + (1|pid:condition), data=data, family=binomial)
# pull the output from the model
output = summary(model)
# extract the coefficients and p-value for conditions 2 and 3. (2nd and 3rd rows of the output)
coef_condition2 = output$coefficients[2,1]
p_value_condition2 = output$coefficients[2,4]
coef_condition3 = output$coefficients[3,1]
p_value_condition3 = output$coefficients[3,4]
# extract the coefficients and p-value for expected values. (4th-7th rows of the output)
coef_ev_2_5 = output$coefficients[4,1]
p_value_ev_2_5 = output$coefficients[4,4]
coef_ev_5 = output$coefficients[5,1]
p_value_ev_5 = output$coefficients[5,4]
coef_ev_7_5 = output$coefficients[6,1]
p_value_ev_7_5 = output$coefficients[6,4]
coef_ev_10 = output$coefficients[7,1]
p_value_ev_10 = output$coefficients[7,4]
# return the coefficients and p-values
variable <-c("condition2", "condition3", "expected_value_2_5", "expected_value_5", "expected_value_7_5", "expected_value_10")
coefs <- c(coef_condition2, coef_condition3, coef_ev_2_5, coef_ev_5, coef_ev_7_5, coef_ev_10)
p_values <- c(p_value_condition2, p_value_condition3, p_value_ev_2_5, p_value_ev_5, p_value_ev_7_5, p_value_ev_10)
# return a data frame with the coefficients and p-values
output <- data.frame(variable, coefs, p_values)
output$sig <- ifelse(output$p_values < 0.05, 1, 0)
return(output)
}
# test the function
simulate_power(1, nparticipants, ntrials, beta_gamble, beta_gamble1, beta_gamble2, beta_gamble3, beta_expectedValue)
power_model <- paramtest::grid_search(simulate_power, params=list(nparticipants = c(30,40,50,60)), n.iter=10,parallel='snow', ncpus=4, output='data.frame', ntrials = 10, beta_gamble =0.5, beta_gamble1 = 0.2, beta_gamble2 = -0.2, beta_gamble3 = -0.2, beta_expectedValue=0.1)
library(dplyr)
power_summary_exp2 <- power_model$results %>%
group_by(nparticipants.test, variable) %>%
summarise(power=mean(sig)) %>%
filter(power > 0.7)
View(power_model)
View(power_summary_exp2)
View(power_model[["results"]])
#### Experiment 3: Repeated measure design with 20 trials
nparticipants = 26
ntrials = 20
beta_gamble = 0.5
beta_gamble1 = 0.2
beta_gamble2 = -0.3
beta_gamble3 = -0.3
beta_expectedValue = 0.1
## There should be nparticipants number of participants. Each participant is randomly assigned to one of the conditions. Each participant completes 10 trials: 2 of each expected value.
# Create a data frame with the data
simulate_power <- function(iter, nparticipants = 26, ntrials = 20, beta_gamble =0.5, beta_gamble1 = 0.3, beta_gamble2 = -0.3, beta_gamble3 = -0.3, beta_expectedValue=0.1) {
##set.seed(123)
# in this experiment, there are 3 conditions. However, each participant is in all conditions. there are 20 trials per participant. 4 of each expected value.
# pid is the participant id. There are nparticipants number of participants.
pid = rep(1:nparticipants, each=ntrials*3)
condition = rep(c("1", "2", "3"), nparticipants)
condition = rep(condition, each=ntrials)
expected_value = rep(c(0, 2.5, 5, 7.5, 10), 4)
expected_value = rep(expected_value, 3)
expected_value = rep(expected_value, nparticipants)
data = data.frame(pid, expected_value, condition)
# the probability of choosing the gamble is 0.5 for participants by default.  However, previous research has shown that the other conditions decrease the likelihood of choosing the gamble by 0.1.
data$gamble = beta_gamble
data$beta_gamble_cond1 = beta_gamble1
data$beta_gamble_cond2 = beta_gamble2
data$beta_gamble_cond3 = beta_gamble3
# Expected value is an ordinal variable. We can assume that the effect of expected value is linear. The probability of choosing the gamble increases by 0.1 for each unit increase in expected value.
data$beta_gamble_expected_value = beta_expectedValue
# Since the model is a logistic mixed effects model, we need to simulate random effects for each participant. Based on the random slope (1|pid) We will assume that the random effect for each participant is normally distributed with a mean of 0 and a standard deviation of 0.1.
random_effect = rnorm(nparticipants, 0, 0.1)
data$random_effect = rep(random_effect, each=ntrials*3)
# Now we can simulate the outcome variable. We will use the logistic function to calculate the probability of choosing the gamble for each trial.
data$prob_gamble = 1/(1+exp(-(data$beta_gamble_cond1*(data$condition=="1") + data$beta_gamble_cond2*(data$condition=="2") + data$beta_gamble_cond3*(data$condition=="3") + data$beta_gamble_expected_value*data$expected_value + data$random_effect)))
# now we can simulate the outcome variable. We will use the logistic function to calculate the probability of choosing the gamble for each trial.
data$gamble = rbinom(nrow(data), 1, data$prob_gamble)
# expected value is an ordinal variable.
data$expected_value = as.factor(data$expected_value)
# Now we can fit the logistic mixed effects model to the data
library(lme4)
model = glmer(gamble ~ condition + expected_value + (1|pid:condition), data=data, family=binomial)
# pull the output from the model
output = summary(model)
# extract the coefficients and p-value for conditions 2 and 3. (2nd and 3rd rows of the output)
coef_condition2 = output$coefficients[2,1]
p_value_condition2 = output$coefficients[2,4]
coef_condition3 = output$coefficients[3,1]
p_value_condition3 = output$coefficients[3,4]
# extract the coefficients and p-value for expected values. (4th-7th rows of the output)
coef_ev_2_5 = output$coefficients[4,1]
p_value_ev_2_5 = output$coefficients[4,4]
coef_ev_5 = output$coefficients[5,1]
p_value_ev_5 = output$coefficients[5,4]
coef_ev_7_5 = output$coefficients[6,1]
p_value_ev_7_5 = output$coefficients[6,4]
coef_ev_10 = output$coefficients[7,1]
p_value_ev_10 = output$coefficients[7,4]
# return the coefficients and p-values
variable <-c("condition2", "condition3", "expected_value_2_5", "expected_value_5", "expected_value_7_5", "expected_value_10")
coefs <- c(coef_condition2, coef_condition3, coef_ev_2_5, coef_ev_5, coef_ev_7_5, coef_ev_10)
p_values <- c(p_value_condition2, p_value_condition3, p_value_ev_2_5, p_value_ev_5, p_value_ev_7_5, p_value_ev_10)
# return a data frame with the coefficients and p-values
output <- data.frame(variable, coefs, p_values)
output$sig <- ifelse(output$p_values < 0.05, 1, 0)
return(output)
}
# test the function
simulate_power(1, nparticipants, ntrials, beta_gamble, beta_gamble1, beta_gamble2, beta_gamble3, beta_expectedValue)
power_model <- paramtest::grid_search(simulate_power, params=list(nparticipants = c(30,40,50,60)), n.iter=10,parallel='snow', ncpus=4, output='data.frame', ntrials = 10, beta_gamble =0.5, beta_gamble1 = 0.2, beta_gamble2 = -0.2, beta_gamble3 = -0.2, beta_expectedValue=0.1)
library(dplyr)
power_summary_exp2 <- power_model$results %>%
group_by(nparticipants.test, variable) %>%
summarise(power=mean(sig)) %>%
filter(power > 0.7)
View(power_summary_exp2)
install.packages("preregr")
install.packages("shinylive")
install.packages("osfr")
install.packages("webr")
install.packages(c("afex", "archive", "arm", "backports", "bain", "bayesplot", "bayestestR", "bda", "bitops", "blavaan", "bookdown", "brio", "broom", "broom.helpers", "broom.mixed", "bslib", "cachem", "callr", "checkmate", "cli", "clock", "colorspace", "correlation", "crayon", "crul", "curl", "dae", "data.table", "datawizard", "DBI", "dbplyr", "dbscan", "deldir", "DescTools", "devEMF", "dials", "digest", "downlit", "DT", "effectsize", "emmeans", "estimability", "evaluate", "Exact", "farver", "fastmap", "flextable", "forecast", "fs", "future", "future.apply", "gdtools", "gert", "GGally", "gganimate", "ggeffects", "ggnewscale", "ggpmisc", "ggpp", "ggsci", "ggstats", "gh", "glmmTMB", "globals", "GPArotation", "gptstudio", "gt", "gtable", "gtsummary", "hardhat", "highr", "Hmisc", "htmlTable", "htmltools", "httpgd", "httpuv", "httr2", "huxtable", "igraph", "infer", "insight", "interactions", "ipred", "knitr", "labelled", "lava", "lavaan", "lhs", "lintr", "lme4", "loo", "magick", "markdown", "matlib", "matrixStats", "mclust", "minqa", "mix", "modelbased", "modeldata", "modelsummary", "multcomp", "multcompView", "munsell", "mvtnorm", "nloptr", "nonnest2", "officedown", "officer", "openssl", "openxlsx", "parallelly", "parameters", "parsnip", "party", "pbkrtest", "PearsonDS", "performance", "pkgbuild", "pkgdown", "pkgload", "polyclip", "posterior", "processx", "prodlim", "promises", "ps", "psych", "psychTools", "quantreg", "quarto", "QuickJSR", "ragg", "rcompanion", "Rcpp", "RcppArmadillo", "RcppEigen", "RcppParallel", "RCurl", "reactR", "recipes", "remotes", "rempsyc", "renv", "reprex", "reticulate", "rgl", "rio", "rlang", "rmarkdown", "robustbase", "roxygen2", "rsample", "rsconnect", "rstan", "rstudioapi", "RUnit", "rvest", "s2", "sass", "servr", "sf", "shape", "shiny", "shinycssloaders", "shinylive", "simstudy", "sjmisc", "sjPlot", "sjstats", "slam", "sp", "SparseM", "splus2R", "StanHeaders", "stringi", "styler", "survey", "systemfonts", "tables", "testthat", "texreg", "textshape", "textshaping", "tidymodels", "tidyselect", "tidySEM", "tinytex", "tm", "TMB", "tseries", "tune", "tweenr", "urca", "usethis", "uuid", "V8", "websocket", "withr", "wk", "workflows", "workflowsets", "writexl", "xaringan", "xfun", "XML", "xopen", "xts", "yaml", "yardstick", "yulab.utils"))
install.packages("cli")
install.packages("cli")
install.packages(c("archive", "backports", "bain", "bitops", "blavaan", "cachem", "checkmate", "cli", "clock", "colorspace", "dbscan", "DescTools", "devEMF", "digest", "farver", "fastmap", "forecast", "fs", "future", "gert", "Hmisc", "httpgd", "httr2", "ipred", "knitr", "lhs", "lme4", "magick", "mclust", "minqa", "mix", "mvtnorm", "nloptr", "openssl", "openxlsx", "parallelly", "party", "PKI", "polyclip", "prodlim", "ps", "quantreg", "QuickJSR", "ragg", "Rcpp", "RcppArmadillo", "RcppParallel", "RCurl", "reticulate", "rlang", "robustbase", "roxygen2", "s2", "simstudy", "slam", "sp", "SparseM", "StanHeaders", "stringi", "systemfonts", "textshaping", "TMB", "tseries", "unigd", "urca", "uuid", "websocket", "wk", "xfun", "XML", "xts", "yaml"))
library(tidymodels)
library(cobifnirs)
# install.packages("devtools")
devtools::install_github("christopherjwilson/cobifnirs")
library(cobifnirs)
data("test1.r")
data <- read.csv(system.file("extdata", "test1.nir", package = "cobifnirs"))
nirData <- read.csv(system.file("extdata", "test1.nir", package = "cobifnirs"))
markerData <- read.csv(system.file("extdata", "test1.mrk", package = "cobifnirs"))
addmarker(nirData)
add_markers(nirData)
nirData <- as.character(system.file("extdata", "test1.nir", package = "cobifnirs"))
import_nirs(nirData)
mydata <- import_nirs(nirData)
add_markers(mydata)
mydata <- add_markers(mydata)
View(mydata)
mydata <- add_markers(mydata, removeDuplicates = TRUE)
View(mydata)
setwd("~/")
nirsData <- import_nirs("XY_006_1.nir")
library(cobifnirs)
nirsData <- import_nirs("XY_006_1.nir")
nirsData <- add_markers(nirsData)
install.packages("poLCA")
install.packages("Superpower")
library(Superpower)
design_result <- ANOVA_design(design = "3w*2w",
n = 65,
mu = c(1,1,1,0.73, 0.87,0.92),
sd = 1,
r = 0.5)
design_result <- ANOVA_design(design = "3w*2w",
n = 65,
mu = c(1,1,1,0.73, 0.87,0.92),
sd = 1,
r = 0.5)
design_result <- ANOVA_design(design = "3w*2w",
n = 65,
mu = c(1,1,1,0.73, 0.87,0.92),
sd = 1,
r = 0.5)
design_result
design_result <- ANOVA_design(design = "2w*3w",
n = 65,
mu = c(1,1,1,0.73, 0.87,0.92),
sd = 1,
r = 0.5)
p_a <- plot_power(design_result,
max_n = 100,
plot = TRUE,
verbose = TRUE)
)
design_result <- ANOVA_design(design = "2w*3w",
n = 65,
mu = c(1,1,1,0.73, 0.87,0.92),
sd = 0.2,
r = 0.5)
p_a <- plot_power(design_result,
max_n = 100,
plot = TRUE,
verbose = TRUE)
design_result <- ANOVA_design(design = "2w*3w",
n = 65,
mu = c(1,1,1,11, 13,8),
sd = 13.9,
r = 0.5)
p_a <- plot_power(design_result,
max_n = 100,
plot = TRUE,
verbose = TRUE)
sqrt(52)
sqrt(52) * 3
design_result <- ANOVA_design(design = "2w*3w",
n = 65,
mu = c(1,1,1,6, 11,6),
sd = 10.83,
r = 0.5)
p_a <- plot_power(design_result,
max_n = 100,
plot = TRUE,
verbose = TRUE)
p_a <- plot_power(design_result,
max_n = 100,
plot = TRUE,
verbose = TRUE,
desired_power = 80)
data("bfi")
library(psych)
data("bfi")
bfidata <- bfi[1:25] %>% na.omit()
describe(bfidata)
bfidata <- bfi[1:25] %>% na.omit()
describe(bfidata)
library(tidyverse)
data("bfi")
bfidata <- bfi[1:25] %>% na.omit()
describe(bfidata)
bfidata %>% complete.cases() %>% sum()
setwd("~/GitHub/intro_to_r/examples")
library(psych)
library(tidyverse)
data("bfi")
force(bfi)
force(bfi.keys)

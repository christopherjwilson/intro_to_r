arrange(desc(n)) %>%
filter(!is.na(evergambled)) %>%
filter(evergambled != "")
evergambled <- responses %>%
select(evergambled) %>%
group_by(evergambled) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(!is.na(evergambled)) %>%
filter(evergambled != "")
evergambled
ggplot(evergambled, aes(x = evergambled, y = (n/117) *100, fill = evergambled )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Have respondents ever gambled on sports",
x = "Response",
y = "% of respondents (current n = 117") +
theme_minimal() +
theme(legend.position = "none")
followback <- responses %>%
select(followback_)
followback <- responses %>%
select(starts_with("followback_")) %>%
pivot_longer(everything(), names_to = "question", values_to = "response")
followback <- responses %>%
select(starts_with("followback_"))
followback
View(followback)
followback <- followback %>%
mutate(across(everything(), as.character))
followback <- followback %>%
pivot_longer(everything(), names_to = "question", values_to = "response")
followback
followback$question <- gsub("followback_copy_", "", followback$question)
followback
followback <- responses %>%
select(starts_with("followback_"), id)
followback <- followback %>%
mutate(across(everything(), as.character))
followback <- followback %>%
pivot_longer(-id, names_to = "question", values_to = "response")
followback
followback$question <- gsub("followback_copy_", "", followback$question)
followback
followback$response[is.na(followback$response) | followback$response == ""] <- "0"
followback$response <- gsub("Up to £", "", followback$response)
# convert response to numeric
followback$response <- as.numeric(followback$response)
followback
followback$response[is.na(followback$response)] <- 0
ggplot(followback, aes(x = question, y = response, group = id)) +
geom_line(alpha = 0.1, color = "blue") +
geom_point(alpha = 0.1, color = "blue") +
labs(title = "Amount bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none") +
scale_y_continuous(labels = scales::dollar_format(prefix = "£")) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(followback, aes(x = question, y = response, group = id, color = id)) +
geom_line(alpha = 0.3) +
geom_smooth(se = FALSE, color = "blue") +
labs(title = "Amount of money bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback, aes(x = question, y = response, color = id)) +
# geom_line(alpha = 0.3) +
geom_smooth(se = FALSE, color = "blue", alpha = 0.3) +
labs(title = "Amount of money bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback, aes(x = question, y = response, group = id, color = id)) +
# geom_line(alpha = 0.3) +
geom_smooth(se = FALSE, color = "blue", alpha = 0.3) +
labs(title = "Amount of money bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback, aes(x = question, y = response, group = id, color = id)) +
# geom_line(alpha = 0.3) +
geom_smooth(se = FALSE, color = id, alpha = 0.3) +
labs(title = "Amount of money bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback, aes(x = question, y = response, group = id, color = id)) +
# geom_line(alpha = 0.3) +
geom_smooth(se = FALSE, alpha = 0.3) +
labs(title = "Amount of money bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback, aes(x = question, y = response, group = id, color = id)) +
geom_line(alpha = 0.3) +
#geom_smooth(se = FALSE, alpha = 0.3) +
labs(title = "Amount of money bet by respondents over the followback period",
x = "Day of followback period",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
followback_summary <- followback %>%
group_by(id) %>%
summarise(mean_bet = mean(response, na.rm = TRUE)) %>%
ungroup()
followback_summary
ggplot(followback_summary, aes(x = mean_bet)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Mean Amounts Bet by Respondents",
x = "Mean Amount Bet (£)",
y = "Number of Respondents") +
theme_minimal()
ggplot(followback_summary, aes(x = mean_bet)) +
geom_histogram(binwidth = 2, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Mean Amounts Bet by Respondents",
x = "Mean Amount Bet (£)",
y = "Number of Respondents") +
theme_minimal()
ggplot(followback_summary, aes(x = "", y = mean_bet)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 2) +
labs(title = "Mean Amounts Bet by Participants",
x = "Participants",
y = "Mean Amount Bet (£)") +
theme_minimal() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank())
followback_summary <- followback %>%
group_by(id) %>%
summarise(mean_bet = mean(response, na.rm = TRUE), min_bet = min(response, na.rm = T), max_bet = max(response, na.rm=TRUE)) %>%
ungroup()
ggplot(followback_summary, aes(x = reorder(id, mean_bet), y = mean_bet)) +
geom_point(size = 3, color = "blue") +
geom_errorbar(aes(ymin = min_bet, ymax = max_bet), width = 0.2, color = "blue") +
coord_flip() +
labs(title = "Mean amounts bet by participants",
x = "Participant ID",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback_summary, aes(x = reorder(id, mean_bet), y = mean_bet)) +
geom_point(size = 3, color = "blue") +
geom_errorbar(aes(ymin = min_bet, ymax = max_bet), width = 0.2, color = "blue") +
labs(title = "Mean amounts bet by participants",
x = "Participant ID",
y = "Amount bet (£)") +
theme_minimal() +
theme(legend.position = "none")
ggplot(followback_summary, aes(x = reorder(id, mean_bet), y = mean_bet)) +
geom_point(size = 3, color = "blue")
followback_nonzero <- followback %>%
group_by(id) %>%
summarise(n_nonzero = sum(response > 0)) %>%
ungroup()
followback_nonzero
ggplot(followback_nonzero, aes(x = reorder(id, n_nonzero), y = n_nonzero)) +
geom_bar(stat = "identity", fill = "blue") +
coord_flip() +
labs(title = "Number of days respondents placed a bet",
x = "Participant ID",
y = "Number of days bet (out of 14)") +
theme_minimal()
ggplot(followback_nonzero, aes(x = reorder(id, n_nonzero), y = n_nonzero)) +
geom_bar(stat = "identity", fill = "blue") +
labs(title = "Number of days respondents placed a bet",
x = "Participant",
y = "Number of days a bet was placed in the last month") +
theme_minimal() +
# remove the x axis text
theme(axis.text.x = element_blank())
ggplot(followback_nonzero, aes(x = reorder(id, n_nonzero), y = n_nonzero)) +
geom_bar(stat = "identity", fill = "blue") +
labs(title = "Number of days respondents placed a bet in the last month",
x = "Participant",
y = "Number of days") +
theme_minimal() +
# remove the x axis text
theme(axis.text.x = element_blank())
ggplot(screensport, aes(x = question, y = (n/117) *100, fill = question )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "How respondents engage with sport",
x = "Question",
y = "% of respondents") +
theme_minimal() +
theme(legend.position = "none")
ggplot(whichsport, aes(x = reorder(question, n), y = (n/117) *100, fill = question )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Which sports respondents follow most closely",
x = "Sport",
y = "% of respondents") +
theme_minimal() +
theme(legend.position = "none")
evergambled <- responses %>%
select(evergambled) %>%
group_by(evergambled) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(!is.na(evergambled)) %>%
filter(evergambled != "")
evergambled
107/117
ggplot(whichsportgambled, aes(x = reorder(question, n), y = (n/117) *100, fill = question )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Which sports respondents have gambled on",
x = "Sport",
y = "% of respondents (current n = 117") +
theme_minimal() +
theme(legend.position = "none")
ggplot(whichsportgambled, aes(x = reorder(question, n), y = (n/117) *100, fill = question )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Which sports respondents have gambled on",
x = "Sport",
y = "% of respondents" +
theme_minimal() +
theme(legend.position = "none")
ggplot(whichsportgambled, aes(x = reorder(question, n), y = (n/117) *100, fill = question )) +
ggplot(whichsportgambled, aes(x = reorder(question, n), y = (n/117) *100, fill = question )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Which sports respondents have gambled on",
x = "Sport",
y = "% of respondents (current n = 117") +
theme_minimal() +
theme(legend.position = "none")
ggplot(whichsportgambled, aes(x = reorder(question, n), y = (n/117) *100, fill = question )) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Which sports respondents have gambled on",
x = "Sport",
y = "% of respondents") +
theme_minimal() +
theme(legend.position = "none")
library(limer)
library(dplyr)
library(tidyr)
library(ggplot2)
library(janitor)
library(dplyr)
#
# #change the next options (website, user, password)
options(lime_api = 'https://survey.christopherjwilson.uk/admin/remotecontrol')
options(lime_username = 'admin_lime')
options(lime_password = 'pjCXsZ5s6xaRQ9r')
# #############################################################
#
#
# # first get a session access key
get_session_key()
#
# # list all surveys. A dataframe is returned
survey_df<-call_limer(method='list_surveys')
print(survey_df)
#
#
# # Get the number of completed responses for a survey
responses <- get_responses("186854")
#
# # count the number of responses
#
responses %>%
count()
# clean names
responses <- responses %>%
clean_names()
# group by token and count the number of responses
responses %>%
group_by(token) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
print()
# identify dupicate ip addresses in each token
responses %>%
group_by(token, ipaddr) %>%
summarise(n = n()) %>%
arrange(desc(n)) %>%
filter(n > 1) %>%
print()
# filter for 1 token aQzQRcrneuhTTmK
mufc_reddit <- responses %>%
filter(token == "aQzQRcrneuhTTmK") %>%
select(token, ipaddr, startlanguage, startdate, lastpage, submitdate) %>%
arrange(startdate)
# download email addresses for vouchers
voucher_details <- get_responses("225942")
voucher_details <- voucher_details %>%
clean_names() %>%
filter(!is.na(email)) %>%
distinct()
# filter our empty email addresses
voucher_details <- voucher_details %>%
filter(email != "")
# filter out if the refurl  is not 	https://survey.christopherjwilson.uk/186854
voucher_details <- voucher_details %>%
filter(refurl == "https://survey.christopherjwilson.uk/186854")
non_mufc_vouchers <- voucher_details %>%
filter(tokenid != "aQzQRcrneuhTTmK")
View(responses)
View(voucher_details)
already_sent <- readClipboard()
not_sent <- voucher_details %>%
filter(!tokenid %in% already_sent) %>%
filter(tokenid != "aQzQRcrneuhTTmK")
not_sent
View(not_sent)
already_sent
# convert to a dataframe
already_sent <- as.data.frame(already_sent)
View(already_sent)
already_sent <- readClipboard()
already_sent <- readClipboard()
already_sent <- readClipboard()
not_sent <- voucher_details %>%
filter(!pid %in% already_sent) %>%
filter(tokenid != "aQzQRcrneuhTTmK")
not_sent
View(not_sent)
install.packages("tidyverse")
simulated_data <- []
## Power simulation for independent two-sample t-test
# Load necessary libraries
library(pwr)
library(ggplot2)
library(dplyr)
library(tidyr)
# Step 1: Some parameters
alpha <- 0.05  # Significance level
n1 <- 30       # Sample size for group 1
n2 <- 30       # Sample size for group 2
sd1 <- 10      # Standard deviation for group 1
sd2 <- 10      # Standard deviation for group 2
mean1 <- 100   # Mean for group 1
mean2 <- 110   # Mean for group 2
# Step 2: Calculate effect size
effect_size <- (mean2 - mean1) / sqrt((sd1^2 + sd2^2) / 2)
# Step 3: Simulate data
set.seed(123)  # For reproducibility
simulated_data <- list()
sim_data <- function(nsims) {
for (i in 1:nsims) {
group1 <- rnorm(n1, mean = mean1, sd = sd1)
group2 <- rnorm(n2, mean = mean2, sd = sd2)
data <- data.frame(
value = c(group1, group2),
group = factor(rep(c("Group 1", "Group 2"), each = n1))
)
t_test_result <- t.test(value ~ group, data = data)
simulated_data[[i]] <<- list(
t_statistic = t_test_result$statistic,
p_value = t_test_result$p.value,
conf_int = t_test_result$conf.int,
mean_diff = mean(group2) - mean(group1)
)
}
return(do.call(rbind, lapply(simulated_data, as.data.frame)))
}
results <- sim_data(10)
View(results)
power <- results %>%
summarise(power = mean(p_value < alpha))
power
effect_size
# Step 1: Some parameters
alpha <- 0.05  # Significance level
n1 <- 30       # Sample size for group 1
n2 <- 30       # Sample size for group 2
sd1 <- 1      # Standard deviation for group 1
sd2 <- 1      # Standard deviation for group 2
mean1 <- 100   # Mean for group 1
mean2 <- 110   # Mean for group 2
# Step 2: Calculate effect size
effect_size <- (mean2 - mean1) / sqrt((sd1^2 + sd2^2) / 2)
Step 1: Some parameters
# Step 1: Some parameters
alpha <- 0.05  # Significance level
n1 <- 30       # Sample size for group 1
n2 <- 30       # Sample size for group 2
sd1 <- 20      # Standard deviation for group 1
sd2 <- 20     # Standard deviation for group 2
mean1 <- 100   # Mean for group 1
mean2 <- 110   # Mean for group 2
# Step 2: Calculate effect size
effect_size <- (mean2 - mean1) / sqrt((sd1^2 + sd2^2) / 2)
# Step 1: Some parameters
alpha <- 0.05  # Significance level
n1 <- 30       # Sample size for group 1
n2 <- 30       # Sample size for group 2
sd1 <- 20      # Standard deviation for group 1
sd2 <- 20     # Standard deviation for group 2
mean1 <- 100   # Mean for group 1
mean2 <- 105   # Mean for group 2
# Step 2: Calculate effect size
effect_size <- (mean2 - mean1) / sqrt((sd1^2 + sd2^2) / 2)
View(simulated_data)
## Power simulation for independent two-sample t-test
# Load necessary libraries
library(tidyverse)
# Step 1: Some parameters
alpha <- 0.05  # Significance level
n1 <- 30       # Sample size for group 1
n2 <- 30       # Sample size for group 2
sd1 <- 20      # Standard deviation for group 1
sd2 <- 20     # Standard deviation for group 2
mean1 <- 100   # Mean for group 1
mean2 <- 105   # Mean for group 2
# Step 2: Calculate effect size
effect_size <- (mean2 - mean1) / sqrt((sd1^2 + sd2^2) / 2)
# Step 3: Simulate data
set.seed(123)  # For reproducibility
simulated_data <- list()
sim_data <- function(nsims) {
for (i in 1:nsims) {
group1 <- rnorm(n1, mean = mean1, sd = sd1)
group2 <- rnorm(n2, mean = mean2, sd = sd2)
data <- data.frame(
value = c(group1, group2),
group = factor(rep(c("Group 1", "Group 2"), each = n1))
)
t_test_result <- t.test(value ~ group, data = data)
simulated_data[[i]] <<- list(
t_statistic = t_test_result$statistic,
p_value = t_test_result$p.value,
conf_int = t_test_result$conf.int,
mean_diff = mean(group2) - mean(group1)
)
}
# return the results as a data frame using tidyverse approach
results_df <- bind_rows(simulated_data) %>%
as_tibble()
}
# run the simulation for a certain number of simulations
results <- sim_data(10)
# Step 4: Calculate power
power <- results %>%
summarise(power = mean(p_value < alpha))
power
library(readr)
practical5_data <- read_csv("C:/Users/wilso/Downloads/practical5_data.csv")
View(practical5_data)
intmodel <- lm(depression ~ anxiety * attention)
intmodel <- lm(depression ~ anxiety * attention, data = practical5_data)
summary(intmodel)
library(rockchalk)
ps <- plotSlopes(intmodel, plotx = "anxiety", modx = "attention")
ps <- plotSlopes(intmodel, plotx = "anxiety", modx = "attention", interval = "confidence", modxVals = "std.dev")
ps
testSlopes(ps)
ts <- testSlopes(ps)
plot(ts)
plot(ts)
pwr.chisq.test(#w = 0.2,          #  calculated V here
df = 1,            # Your degrees of freedom
sig.level = 0.05,
N = 200,
power = 0.80)
library(pwr)
pwr.chisq.test(#w = 0.2,          #  calculated V here
df = 1,            # Your degrees of freedom
sig.level = 0.05,
N = 200,
power = 0.80)
pwr.chisq.test(w = 0.2,          #  calculated V here
df = 1,            # Your degrees of freedom
sig.level = 0.05,
# N = 200,
power = 0.80)
setwd("R:/GitHub/intro_to_r/practicals")
practical6_data <- read.csv("practical6_data.csv")
library(mediation) #Mediation package
library(multilevel) #Sobel Test
library(bda) #Another Sobel Test option
library(gvlma) #Testing Model Assumptions
library(stargazer) #Handy regression tables
fitm <- lm(pmi ~ cod, data = practical6_data)
fitm <- lm(pmi ~ cond, data = practical6_data)
fity <- lm(reaction ~ cond + pmi)
View(practical6_data)
fity <- lm(reaction ~ cond + pmi data= practical6_data)
fity <- lm(reaction ~ cond + pmi, data= practical6_data)
mediate(fitm, fity, treat="cond", mediator = "pmi")
fitmed <- mediate(fitm, fity, treat="cond", mediator = "pmi")
summary(fitmed)
fitmed <- mediate(fitm, fity, treat="cond", mediator = "pmi")
summary(fitmed)
fitmed <- mediate(fitm, fity, treat="cond", mediator = "pmi")
summary(fitmed)
plot(fitmed)
fitmed <- mediate(fitm, fity, treat="cond", mediator = "pmi", sims = 5000)
summary(fitmed)
plot(fitmed)
fitxy <- lm(reaction ~ cond, data = practical6_data)
fitmy <- lm(reaction ~ pmi, data = practical6_data)
fitxm <- lm(pmi ~ cond, data = practical6_data)
fitymx <- lm(cond ~ reaction + pmi, data= practical6_data)
stargazer(fitxy, fitxm, fitmy, fitymx)
anova(fitxy, fitxm, fitmy, fitymx)
library(sjPlot)
tab_model(fitxy, fitxm, fitmy, fitymx)
summary(fitmed)
plot(fitmed)
set.seed(234)
fitmed <- mediate(fitm, fity, treat="cond", mediator = "pmi", sims = 5000)
summary(fitmed)

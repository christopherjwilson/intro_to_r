plot(x3,y3, main="Weak correlation", xlab="X", ylab="Y")
# data for a strong positive correlation (n = 100)
x <- rnorm(100, mean = 50, sd = 10)
y <- x + rnorm(100, mean = 0, sd = 5)
# data for a strong negative correlation (n = 100)
x2 <- rnorm(100, mean = 50, sd = 10)
y2 <- -x2 + rnorm(100, mean = 0, sd = 5)
# data for a weak correlation (n = 100)
x3 <- rnorm(100, mean = 50, sd = 10)
y3 <- rnorm(100, mean = 10, sd = 100)
# plot the data
par(mfrow=c(1,3))
plot(x,y, main="Strong positive correlation", xlab="X", ylab="Y")
plot(x2,y2, main="Strong negative correlation", xlab="X", ylab="Y")
plot(x3,y3, main="Weak correlation", xlab="X", ylab="Y")
bookdown:::serve_book()
data <- read.csv("practical1_data.csv")
data <- read.csv("practical1_data.csv")
setwd("~/GitHub/intro_to_r")
setwd("~/GitHub/intro_to_r/examples")
data <- read.csv("practical1_data.csv")
View(data)
mean(data$age)
sd(age)
sd(data$age)
setwd("~/GitHub/intro_to_r/examples")
2 + 67
2 + 65
# add 2 numbers together
2 + 65
add 2 numbers together
result  <-  2 + 65
result * 2
result * 2
result  <-  2 + 67
result * 2
rm(result)
result      <-           2 + 67
rm(result  )
ages <- c(23,45,67,13)
ages <- ages * 2
mean(ages)
sd(ages)
library(readr)
practical1_data <- read_csv("practical1_data.csv")
View(practical1_data)
# import data
library(readr)
practical1_data <- read_csv("practical1_data.csv")
View(practical1_data)
practical3_data <- read_csv("docs/practicals/practical3_data.csv")
library(readr)
practical3_data <- read_csv("docs/practicals/practical3_data.csv")
View(practical3_data)
model <- lm(avoidance ~ depression, data = practical3_data)
plot(model)
summary(model)
model2 <- lm(depression ~ treatment, data = practical3_data)
summary(model2)
setwd("~/GitHub/intro_to_r/examples")
setwd("~/GitHub/intro_to_r")
data(mtcars)
force(mtcars)
data(mtcars)
force(mtcars)
plot(mtcars$mpg, mtcars$hp)
cor.test(mtcars$mpg, mtcars$hp)
hist(mtcars$mpg)
hist(mtcars$hp)
cor.test(mtcars$mpg, mtcars$hp, "spearman")
cor.test(mtcars$mpg, mtcars$hp, method ="spearman")
setwd("~/GitHub/intro_to_r/examples")
data(mtcars)
force(mtcars)
plot(mtcars$mpg, mtcars$hp)
cor.test(mtcars$mpg, mtcars$hp)
hist(mtcars$mpg)
hist(mtcars$hp)
hist(mtcars$mpg)
cor.test(mtcars$mpg, mtcars$hp, method ="spearman")
setwd("~/GitHub/intro_to_r")
bookdown:::serve_book()
#plot the data
plot(mtcars$mpg, mtcars$hp)
#plot the data
plot(mtcars$hp, mtcars$mpg)
# use ggplot to plot the data and add a regression line
library(ggplot2)
ggplot(mtcars, aes(x=hp, y=mpg)) + geom_point() + geom_smooth(method="lm")
AIC(model)
model <- lm(mpg ~ hp, data=mtcars)
plot(model)
AIC(model)
BIC(model)
#load the data
data(mtcars)
force(mtcars)
plot(mtcars$hp, mtcars$mpg)
# use ggplot to plot the data and add a regression line
library(ggplot2)
ggplot(mtcars, aes(x=hp, y=mpg)) + geom_point() + geom_smooth(method="lm")
model <- lm(mpg ~ hp, data=mtcars)
summary(model)
plot(model)
AIC(model)
BIC(model)
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
library(tidyverse)
regression_data <- read.csv("Datasets/regression_data.csv")
View(regression_data)
View(regression_data)
# specify the reference level - this is more useful when we have more than 2 levels
regression_data$treatment <- relevel(regression_data$treatment, ref = "therapy1") #<1>
# specify the reference level - this is more useful when we have more than 2 levels
regression_data$treatment <- as.factor(regression_data$treatment) #<0>
regression_data$treatment <- as.factor(regression_data$treatment) #<0>
regression_data$treatment <- relevel(regression_data$treatment_group, ref = "therapy1") #<1>
regression_data$treatment <- as.factor(regression_data$treatment_group) #<0>
regression_data$treatment <- relevel(regression_data$treatment_group, ref = "therapy1") #<1>
regression_data$treatment_group <- as.factor(regression_data$treatment_group) #<0>
regression_data$treatment <- relevel(regression_data$treatment_group, ref = "therapy1") #<1>
regression_model2 <- lm(depression ~ treatment_group, data = regression_data) #<2>
regression_model2 <- lm(agression_level ~ treatment_group, data = regression_data) #<2>
regression_model2 <- lm(aggression_level ~ treatment_group, data = regression_data) #<2>
summary(regression_model2) #<3>
# Load the mtcars dataset
data(mtcars)
# Convert the cyl variable to a factor variable
mtcars$cyl <- as.factor(mtcars$cyl)
# Fit a regression model with the cyl variable as the predictor variable
regression_model3 <- lm(mpg ~ cyl, data = mtcars) #<1>
# Summary of the model
summary(regression_model3) #<2>
# Compare the levels of the predictor variable
library(emmeans)
emmeans(regression_model3, "cyl") #<3>
# Load the mtcars dataset
data(mtcars)
# Convert the cyl variable to a factor variable
mtcars$cyl <- as.factor(mtcars$cyl)
# Fit a regression model with the cyl variable as the predictor variable
regression_model3 <- lm(mpg ~ cyl, data = mtcars) #<1>
# Summary of the model
summary(regression_model3) #<2>
# Compare the levels of the predictor variable with pairwise comparisons
library(emmeans)
emmeans(regression_model3, pairwise ~ cyl) #<3>
data(mtcars)
force(mtcars)
View(mtcars)
mtcars$cyl <- as.factor(mtcars$cyl)
model <- lm(mpg ~ cyl, data=mtcars)
summary(model)
emmeans(model, "cyl")
emmeans <- emmeans(model, "cyl")
pairs(emmeans)
emmip(model, cyl ~ mpg)
emmip(model, cyl)
emmip(model)
library(DiagrammeR)
grViz("
digraph {
rankdir="LR"
library(DiagrammeR)
grViz("
digraph {
rankdir='LR'
Selfesteem -> Depression
Loneliness -> Depression
Stress -> Depression
Gender -> Depression
Age -> Depression
")
}
library(DiagrammeR)
grViz("
digraph {
rankdir='LR'
Selfesteem -> Depression
Loneliness -> Depression
Stress -> Depression
Gender -> Depression
Age -> Depression
")
library(DiagrammeR)
grViz("
digraph {
rankdir='LR'
Selfesteem -> Depression
Loneliness -> Depression
Stress -> Depression
Gender -> Depression
Age -> Depression}
")
# same plot as above, but in dot format
grViz("
digraph {
rankdir="TB"
# same plot as above, but in dot format
grViz("
digraph {
rankdir='TB'
subgraph cluster_0 {
label = 'Model 1'
gender -> depression
age -> depression
}
subgraph cluster_1 {
label = 'Model 2'
gender -> depression
age -> depression
stress -> depression
loneliness -> depression
}
subgraph cluster_2 {
label = 'Model 3'
gender -> depression
age -> depression
stress -> depression
loneliness -> depression
selfesteem -> depression
}
} ")
# same plot as above, but in dot format
grViz("
digraph {
rankdir='TB'
subgraph cluster_0 {
label = 'Model 1'
gender -> depression
age -> depression
}
subgraph cluster_1 {
label = 'Model 2'
gender -> depression
age -> depression
stress -> depression
loneliness -> depression
}
subgraph cluster_2 {
label = 'Model 3'
gender -> depression
age -> depression
stress -> depression
loneliness -> depression
selfesteem -> depression
}
} ")
# same plot as above, but in dot format
grViz("
digraph {
rankdir='TB'
subgraph cluster_0 {
label = 'Model 1'
gender -> depression
age -> depression
}
subgraph cluster_1 {
label = 'Model 2'
gender -> depression
age -> depression
stress -> depression
loneliness -> depression
}
subgraph cluster_2 {
label = 'Model 3'
gender -> depression
age -> depression
stress -> depression
loneliness -> depression
selfesteem -> depression
}
} ")
library(DiagrammeR)
graph1 <- grViz("
digraph {
rankdir='LR'
Selfesteem -> Depression
Loneliness -> Depression
Stress -> Depression
Gender -> Depression
Age -> Depression}
")
render_graph(graph1)
library(DiagrammeR)
graph1 <- grViz("
digraph {
rankdir='LR'
Selfesteem -> Depression
Loneliness -> Depression
Stress -> Depression
Gender -> Depression
Age -> Depression
}
")
render_graph(graph1)
library(DiagrammeR)
graph1 <- grViz("
digraph {
rankdir="LR"
library(DiagrammeR)
graph1 <- grViz('
digraph {
rankdir="LR"
Selfesteem -> Depression
Loneliness -> Depression
Stress -> Depression
Gender -> Depression
Age -> Depression
}
')
render_graph(graph1)
library(readr)
practical4_data <- read_csv("docs/practicals/practical4_data.csv")
View(practical4_data)
model0 <- lm(data = practical4_data, wellbeing_after_3_months ~ 1)
model1 <- lm(data = practical4_data, wellbeing_after_3_months ~ level_of_severity + treatment_group)
model2 <- lm(data = practical4_data, wellbeing_after_3_months ~ level_of_severity + treatment_group +trust_score)
anova(model0, model1, model2)
summary(model2)
AIC(model1,model2)
AIC(model0,model1,model2)
plot(model1)
library(dplyr)
practical4_data |>
summarise(mean(trust_score))
practical4_data |>
group_by(treatment_group) |>
summarise(mean(trust_score))
practical4_data |>
group_by(treatment_group) |>
summarise(mean(trust_score), mean(wellbeing_after_3_months))
practical4_data |>
group_by(treatment_group) |>
summarise(mean(trust_score), mean(wellbeing_after_3_months))
practical4_data |>
group_by(treatment_group) |>
summarise(mean-ts = mean(trust_score), mean(wellbeing_after_3_months))
practical4_data |>
group_by(treatment_group) |>
summarise(mean_ts = mean(trust_score), mean(wellbeing_after_3_months))
#| fig.cap="Diagram of moderation design"
#| fig.asp=0.5
#| fig.pos="H"
#| fig.align='center'
library(DiagrammeR)
dia1 <- "
digraph moderation_model {
# Nodes
node [shape = rectangle, fontname = Arial, fontsize=9]
iv    [pos = '-1,1!', label = 'Time in\ncounselling']
blank [pos =  '0,1!', label = '', width = 0.001, height = 0.001]
mod   [pos =  '0,2!', label = 'Rapport\nlevel']
dv    [pos =  '1,1!', label = 'General\nwellbeing']
# Hide moderator edges
{ rank = same; blank mod }
# Edges
edge [fontname = Arial, fontsize=8]
mod -> blank
iv -> blank [dir = none]
blank -> dv [minlen = 1]
# Graph
graph [layout = neato, overlap = true, outputorder = edgesfirst]
}"
grViz(dia1)
grViz(dia1)
library(readr)
practical5_data <- read_csv("examples/practical5_data.csv")
View(practical5_data)
mod1 <- lm(depression ~ anxiety * attention)
mod1 <- lm(depression ~ anxiety * attention, data = practical5_data)
gvlma::gvlma(mod1)
mctest::mctest(mod1)
### check model summary
summary(mod1)
library(gvlma)
library(mctest)
library(rockchalk)
### plot the interaction
ps <- plotSlopes(mod1, plotx = "anxiety", modx = "attention", interval = "confidence", modxVals = "std.dev")
ts <- testSlopes(ps)
plot(ts)
View(practical5_data)
View(mod1)
gvlma(mod1)
plot(mod1)
mctest(mod1)
### check model summary
summary(mod1)
### plot the interaction
ps <- plotSlopes(mod1, plotx = "anxiety", modx = "attention", interval = "confidence", modxVals = "std.dev")
### plot the interaction
ps <- plotSlopes(mod1, plotx = "anxiety", modx = "attention", interval = "confidence", modxVals = "std.dev")
ts <- testSlopes(ps)
## data
data(mtcars)
force(mtcars)
library(readr)
album_sales <- read_csv("examples/album_sales.csv")
View(album_sales)
library(readr)
album_sales <- read_csv("examples/album_sales.csv")
View(album_sales)
# intercept only model (null model)
null <- lm(Sales ~ 1)
# intercept only model (null model)
null <- lm(Sales ~ 1, data = album_sales)
summary(null)
mean(album_sales$Sales)
model1 <- lm(Sales ~ AirPlay, data = album_sales)
model1 <- lm(Sales ~ Airplay, data = album_sales)
summary(model1)
library(dplyr)
library(ggplot2)
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm')
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm') +
geom_hline(aes(yintercept = mean(Sales)))
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm') +
geom_hline(aes(yintercept = mean(Sales)), linetype = "dashed")
anova(null, model1)
aic(null,model1)
AIC(null,model1)
model2 <- lm(Sales ~ Airplay + Adverts, data = album_sales)
summary(model2)
anova(null, model1, model2)
AIC(null,model1, model2)
library(mctest)
mctest(model2)
library(dplyr)
library(ggplot2)
library(readr)
album_sales <- read_csv("examples/album_sales.csv")
library(dplyr)
library(ggplot2)
library(readr)
album_sales <- read_csv("examples/album_sales.csv")
# intercept only model (null model)
null <- lm(Sales ~ 1, data = album_sales)
# summary of null model
summary(null)
mean(album_sales$Sales)
# airplay
model1 <- lm(Sales ~ Airplay, data = album_sales)
summary(model1)
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm') +
geom_hline(aes(yintercept = mean(Sales)), linetype = "dashed")
anova(null, model1)
AIC(null,model1)
# airplay and advertising
model2 <- lm(Sales ~ Airplay + Adverts, data = album_sales)
summary(model2)
anova(null, model1, model2)
AIC(null,model1, model2)
# multicollinearity
library(mctest)
mctest(model2)
anova(null, model1, test = "Chisq")
anova(null, model1, test = "LRT")
anova(model1)
library(dplyr)
library(ggplot2)
library(readr)
album_sales <- read_csv("examples/album_sales.csv")
View(album_sales)
null <- lm(Sales ~ 1, data = album_sales)
summary(null)
mean(album_sales$Sales)
model1 <- lm(Sales ~ Airplay, data = album_sales)
summary(model1)
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm')
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm') +
geom_hline(aes(yintercept = mean(Sales)), linetype = "dashed")
anova(null, model1)
library(dplyr)
library(ggplot2)
library(readr)
album_sales <- read_csv("examples/album_sales.csv")
View(album_sales)
model1 <- lm(Sales ~ Airplay, data = album_sales)
summary(model1)
# intercept only model (null model)
null <- lm(Sales ~ 1, data = album_sales)
summary(null)
mean(album_sales$Sales)
anova(null, model1)
album_sales %>%
ggplot(aes(x = Airplay, y = Sales)) +
geom_point() +
geom_smooth(method='lm') +
geom_hline(aes(yintercept = mean(Sales)), linetype = "dashed")
model2 <- lm(Sales ~ Airplay + Adverts, data = album_sales)
summary(model2)
anova(null, model1, model2)
AIC(null,model1, model2)

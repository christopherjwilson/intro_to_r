model2 <- lm(Sales ~ Airplay + Adverts, data = album_sales)
summary(model2)
anova(null, model1, model2)
AIC(null,model1, model2)
library(gvlma)
library(mediation)
library(bda)
library(stargazer)
library(DiagrammeR)
#| fig.cap="Diagram of moderation design"
#| fig.asp=0.5
#| fig.pos="H"
#| fig.align='center'
library(DiagrammeR)
dia1 <- "
digraph moderation_model {
# Nodes
node [shape = rectangle, fontname = Arial, fontsize=9]
iv    [pos = '-1,1!', label = 'Time in\ncounselling']
blank [pos =  '0,1!', label = '', width = 0.001, height = 0.001]
mod   [pos =  '0,2!', label = 'Rapport\nlevel']
dv    [pos =  '1,1!', label = 'General\nwellbeing']
# Hide moderator edges
{ rank = same; blank mod }
# Edges
edge [fontname = Arial, fontsize=8]
mod -> blank
iv -> blank [dir = none]
blank -> dv [minlen = 1]
# Graph
graph [layout = neato, overlap = true, outputorder = edgesfirst]
}"
grViz(dia1)
#| fig.cap="Diagram of moderation design"
#| fig.asp=0.5
#| fig.pos="H"
#| fig.align='center'
library(DiagrammeR)
dia1 <- "
digraph moderation_model {
# Nodes
node [shape = rectangle, fontname = Arial, fontsize=9]
iv    [pos = '-1,1!', label = 'Temperature']
blank [pos =  '0,1!', label = '', width = 0.001, height = 0.001]
mod   [pos =  '0,2!', label = 'Likelihood\nof rain']
dv    [pos =  '1,1!', label = 'People\nat the\nbeach']
# Hide moderator edges
{ rank = same; blank mod }
# Edges
edge [fontname = Arial, fontsize=8]
mod -> blank
iv -> blank [dir = none]
blank -> dv [minlen = 1]
# Graph
graph [layout = neato, overlap = true, outputorder = edgesfirst]
}"
grViz(dia1)
#| fig.cap="Diagram of mediation design"
#| fig.asp=0.5
#| fig.pos="H"
#| fig.align='center'
library(DiagrammeR)
# diagram of treatment -> practice -> mental health
# LR
# treatment -> practice
# practice -> mental health
# treatment -> mental health
edf <-
create_edge_df(
from = c(1, 2, 1),
to = c(2, 3, 3),
color=c("blue","green","red"),
# label = c(" ","-","+"),
fontsize=16)
ndf <- create_node_df(
n=3,
label = c("Screen time", "Social Media", "Lonliness"),
shape = "rectangle",
fillcolor = "white",
width = 1.5,
height = 1,
x=c(1,3,5),
y=c(1,3,1),
fontsize=12,
color="black",
fontcolor="black")
med_graph <-
create_graph(nodes_df = ndf, edges_df = edf)
med_graph %>% render_graph(title = "")
library(readr)
practical6_data <- read_csv("docs/practicals/practical6_data.csv")
View(practical6_data)
## Mediation practical
library(readr)
practical6_data <- read_csv("docs/practicals/practical6_data.csv")
practical6_data <- read_csv("../docs/practicals/practical6_data.csv")
practical6_data <- read_csv("practical6_data.csv")
setwd("~/GitHub/intro_to_r/examples")
practical6_data <- read_csv("practical6_data.csv")
View(practical6_data)
practical6_data$cond <- as.factor(practical6_data$cond)
#1. Total Effect of X on Y
fit <- lm(reaction ~ cond, data=practical6_data)
#2. Path A (X on M)
fita <- lm(pmi ~ cond, data=practical6_data)
#3. Path B (M on Y)
fitb <- lm(reaction ~ pmi, data=practical6_data)
#4. Reversed Path C (Y on X, controlling for M)
fitc <- lm(cond ~ reaction + pmi, data=practical6_data)
library(stargazer)
stargazer(fit, fita, fitb, fitc, type = "text", title = "Baron and Kenny Method")
fitM <- lm(pmi ~ cond,     data=practical6_data) #IV on M;
fitY <- lm(reaction ~ cond + pmi, data=practical6_data) #IV and M on DV;
fitMed <- mediate(fitM, fitY, treat="cond", mediator="pmi")
summary(fitMed)
plot(fitMed)
fitMed <- mediate(fitM, fitY, treat="cond", mediator="pmi", sims = 5000)
summary(fitMed)
plot(fitMed)
fitMed <- mediate(fitM, fitY, treat="cond", mediator="pmi", sims = 1000)
summary(fitMed)
plot(fitMed)
gvlma(fitMed)
gvlma(fitM)
gvlma(fitY)
gvlma(fitM)
plot(fitM)
stargazer(fit, fita, fitb, fitc, type = "text", title = "Baron and Kenny Method")
summary(fitMed)
plot(fitMed)
set.seed(123)
fitMed <- mediate(fitM, fitY, treat="cond", mediator="pmi", sims = 1000)
summary(fitMed)
knitr::include_graphics("img/ggplot2.png")
library(readr)
studentData <- as.data.frame(read_csv("Datasets/studentData.csv"))
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy, color = route)) + #<1>
geom_point() #<2>
library(ggplot2)
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy)) + #<1>
geom_point() #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy, color = route)) + #<1>
geom_point() #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy, color = route)) + #<1>
geom_point() #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy)) + #<1>
geom_point(aes(color = route)) #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy)) + #<1>
geom_point(aes(size = satisfactionLevel)) #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy)) + #<1>
geom_point(aes(size = satisfactionLevel, colour = route)) #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy, size = satisfactionLevel, colour = route)) + #<1>
geom_point() #<2>
ggplot(data=studentData, aes(x=grades,y=hoursOfStudy, size = satisfactionLevel, colour = route, shape = hasDepdendants)) + #<1>
geom_point() #<2>
ggplot(data=studentData, aes(x = route, y = hoursOfStudy)) +
geom_col()
ggplot(data=studentData, aes(x = route, y = hoursOfStudy)) +
stat_summary(fun = mean, geom = "col") +
geom_col()
library(dplyr)
studentData %>%
group_by(route) %>%
summarise(meanHours = mean(hoursOfStudy)) %>%
ggplot(aes(x = route, y = meanHours)) +
geom_col()
ggplot(data=studentData, aes(x = route, y = hoursOfStudy)) +
stat_summary(fun.y =  = mean, geom = "col") +
ggplot(data=studentData, aes(x = route, y = hoursOfStudy)) +
stat_summary(fun.y = mean, geom = "col") +
geom_col()
ggplot(data=studentData, aes(x = route, y = hoursOfStudy)) +
stat_summary(fun = mean, geom = "col") +
geom_col()
ggplot(data=studentData, aes(x = route, y = hoursOfStudy)) +
stat_summary(fun = mean, geom = "col")
studentData %>%
group_by(route) %>%
summarise(meanHours = mean(hoursOfStudy)) %>%
ggplot(aes(x = route, y = meanHours)) +
geom_col() +
labs(title = "Mean hours of study by route",
x = "Route",
y = "Mean hours of study",
caption = "Source: Student data")
studentData %>%
group_by(route) %>%
summarise(meanHours = mean(hoursOfStudy)) %>%
ggplot(aes(x = route, y = meanHours)) +
geom_col() +
labs(title = "Mean hours of study by route",
x = "Route",
y = "Mean hours of study",
caption = "Source: Student data") +
theme_minimal()
library(readr)
studentData <- read_csv("datasets/studentData.csv")
View(studentData)
library(help="mctest")
render_book_slides <- function(...) {
quarto::quarto_render(..., as_job = FALSE)
file.rename("_quarto.yml", "_quarto_book.yml")
file.rename("_quarto_slides.yml", "_quarto.yml")
on.exit(file.rename("_quarto.yml", "_quarto_slides.yml"))
on.exit(file.rename("_quarto_book.yml", "_quarto.yml"), add = TRUE)
quarto::quarto_render(..., as_job = FALSE)
}
render_book_slides()
rlang::last_trace()
file.rename("_quarto_slides.yml", "_quarto.yml")
quarto::quarto_render(..., as_job = FALSE)
quarto::quarto_render()
file.rename("_quarto.yml", "_quarto_slides.yml")
quarto::quarto_render()
quarto::quarto_render()
quarto::quarto_render()
quarto::quarto_render()
quarto::quarto_render()
file.rename("_quarto_slides.yml", "_quarto.yml")
quarto::quarto_render()
quarto::quarto_render()
# load datasets/modData.csv
modData <- read.csv("../datasets/modData.csv")
quarto::quarto_render()
file.rename("_quarto.yml", "_quarto_slides.yml")
source_dir <- "slides/"
# Specify the file extension to copy (e.g., ".pdf")
file_extension <- ".pdf"
# Get a list of all files with the specified extension
csv_files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/slides/"
pdf_files <- list.files(source_dir, pattern = file_extension)
file.copy(file.path(source_dir, pdf_files), dest_dir, overwrite = TRUE)
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, files), dest_dir, overwrite = TRUE)
file.rename("_quarto_practicals.yml", "_quarto.yml")
quarto::quarto_render()
library(webexercises)
practical4_data <- read.csv("practical4_data.csv")
# change the gender variable to a factor
practical4_data$gender <- as.factor(practical4_data$gender)
quarto::quarto_render()
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, files), dest_dir, overwrite = TRUE)
on.exit(file.rename("_quarto.yml", "_quarto_practicals.yml"))
file.rename("_quarto.yml", "_quarto_practicals.yml")
?on.exit
render_book_slides <- function(...) {
file.rename("_quarto_book.yml", "_quarto.yml")
quarto::quarto_render(..., as_job = FALSE)
on.exit(file.rename("_quarto.yml", "_quarto_book.yml"))
file.rename("_quarto_slides.yml", "_quarto.yml")
quarto::quarto_render(..., as_job = FALSE)
on.exit(file.rename("_quarto.yml", "_quarto_slides.yml"), add = TRUE)
file.rename("_quarto_practicals.yml", "_quarto.yml")
quarto::quarto_render(..., as_job = FALSE)
on.exit(file.rename("_quarto.yml", "_quarto_practicals.yml"), add = TRUE)
## copy all pdf files from slides to docs/slides
# Define the directory to search
source_dir <- "slides/"
# Specify the file extension to copy (e.g., ".pdf")
file_extension <- ".pdf"
# Get a list of all files with the specified extension
pdf_files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/slides/"
# copy the files to the destination directory
file.copy(file.path(source_dir, pdf_files), dest_dir, overwrite = TRUE)
## As above, copy all the csv files in the practicals folder to the docs/practicals folder
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, files), dest_dir, overwrite = TRUE)
}
render_book_slides()
render_book_slides <- function(...) {
# copy the file _quarto_book.yml to _quarto.yml
file.copy("_quarto_book.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render(..., as_job = FALSE)
file.copy("_quarto_slides.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render(..., as_job = FALSE)
file.copy("_quarto_practicals.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render(..., as_job = FALSE)
## copy all pdf files from slides to docs/slides
# Define the directory to search
source_dir <- "slides/"
# Specify the file extension to copy (e.g., ".pdf")
file_extension <- ".pdf"
# Get a list of all files with the specified extension
pdf_files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/slides/"
# copy the files to the destination directory
file.copy(file.path(source_dir, pdf_files), dest_dir, overwrite = TRUE)
## As above, copy all the csv files in the practicals folder to the docs/practicals folder
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, files), dest_dir, overwrite = TRUE)
}
render_book_slides()
render_book_slides()
## copy all pdf files from slides to docs/slides
# Define the directory to search
source_dir <- "slides/"
# Specify the file extension to copy (e.g., ".pdf")
file_extension <- ".pdf"
# Get a list of all files with the specified extension
pdf_files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/slides/"
# copy the files to the destination directory
file.copy(file.path(source_dir, pdf_files), dest_dir, overwrite = TRUE)
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, files), dest_dir, overwrite = TRUE)
# Get a list of all files with the specified extension
csv_files <- list.files(source_dir, pattern = file_extension)
# copy the files to the destination directory
file.copy(file.path(source_dir, csv_files), dest_dir, overwrite = TRUE)
file.copy("_quarto_practicals.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render(..., as_job = FALSE)
quarto::quarto_render()
quarto::quarto_render()
# copy the files to the destination directory
file.copy(file.path(source_dir, pdf_files), dest_dir, overwrite = TRUE)
## copy all pdf files from slides to docs/slides
# Define the directory to search
source_dir <- "slides/"
# Specify the file extension to copy (e.g., ".pdf")
file_extension <- ".pdf"
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
csv_files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, csv_files), dest_dir, overwrite = TRUE)
# copy the file
file.copy("_quarto_slides.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render(..., as_job = FALSE)
quarto::quarto_render()
file.copy("_quarto_practicals.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render()
quarto::quarto_render()
quarto::quarto_render()
# Define the directory to search
source_dir <- "practicals/"
# Specify the file extension to copy (e.g., ".csv")
file_extension <- ".csv"
# Get a list of all files with the specified extension
csv_files <- list.files(source_dir, pattern = file_extension)
# Destination directory where you want to copy the files
dest_dir <- "docs/practicals/"
# copy the files to the destination directory
file.copy(file.path(source_dir, csv_files), dest_dir, overwrite = TRUE)
file.copy("_quarto_practicals.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render()
quarto::quarto_render()
file.copy("_quarto_practicals.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render(..., as_job = FALSE)
quarto::quarto_render()
library(car)
bootstrapModel <- Boot(fitMod, R=999) #<1>
#setwd("location") #Working directory
set.seed(123)#Standardizes the numbers generated by rnorm; see Chapter 5
N  <- 100 #Number of participants; graduate students
timeInCounselling  <- abs(rnorm(N, 6, 4)) #IV;
X1 <- abs(rnorm(N, 60, 30)) #Adding some systematic variance for our DV
rapportLevel  <- rnorm(N, 4, 8) #Moderator; years in education
generalWellbeing  <- abs((0.8*-timeInCounselling) * (.1*rapportLevel) + -0.8*timeInCounselling + -0.4*X1 + 10 + rnorm(N, 0, 3)) #DV;
Moddata <- data.frame(timeInCounselling, rapportLevel, generalWellbeing)
#Moderation "By Hand" with centred data
library(gvlma)
fitMod <- lm(generalWellbeing ~ timeInCounselling *rapportLevel , data = Moddata) #Model interacts IV & moderator
library(interactions)
ip <- interact_plot(fitMod, pred = timeInCounselling, modx = rapportLevel)
ip
fitMod <- lm(generalWellbeing ~ timeInCounselling *rapportLevel , data = Moddata) #Model interacts IV & moderator
timeInCounselling_centred    <- scale(timeInCounselling, center=TRUE, scale=FALSE) #Centering X;
timeInCounselling
head(timeInCounselling_centred)
mean(timeInCounselling)
timeInCounselling[1]-timeInCounselling_centred[1]
#Centering Data
Moddata$timeInCounselling_centred    <- c(scale(timeInCounselling, center=TRUE, scale=FALSE))
#Centering IV;
Moddata$rapportLevel_centred    <- c(scale(rapportLevel,  center=TRUE, scale=FALSE)) #Centering moderator;
#Moderation "By Hand" with centred data
library(gvlma)
fitMod <- lm(generalWellbeing ~ timeInCounselling_centred *rapportLevel_centred  , data = Moddata) #Model interacts IV & moderator
library(interactions)
ip <- interact_plot(fitMod, pred = timeInCounselling_centred, modx = rapportLevel_centred)
ip
library(gvlma)
gvlma(fitMod)
fitMod <- lm(generalWellbeing ~ timeInCounselling_centred *rapportLevel_centred  , data = Moddata) #Model interacts IV & moderator
#Model interacts IV & moderator
summary(fitMod)
ip
library(rockchalk)
fitMod <- lm(generalWellbeing ~ timeInCounselling *rapportLevel  , data = Moddata)
summary(fitMod)
slopes <- plotSlopes(fitMod, modx = "rapportLevel", plotx = "timeInCounselling") #<1>
testSlopes <- testSlopes(slopes) #<2>
plot(testSlopes) #<3>
library(car)
bootstrapModel <- Boot(fitMod, R=999) #<1>
confint(fitMod) #<2>
confint(bootstrapModel) #<3>
summary(bootstrapModel) #<4>
hist(bootstrapModel) #<5>
# copy the file _quarto_book.yml to _quarto.yml
file.copy("_quarto_book.yml", "_quarto.yml", overwrite = T)
# copy the file _quarto_book.yml to _quarto.yml
file.copy("_quarto_book.yml", "_quarto.yml", overwrite = T)
quarto::quarto_render()
quarto::quarto_render()
quarto::quarto_render()
library(readr)
practical5_data <- read_csv("examples/practical5_data.csv")
View(practical5_data)
## moderation analysis
library(gvlma)
library(mctest)
library(rockchalk)
library(car)
### Import data
practical5_data <- read_csv("examples/practical5_data.csv")
View(practical5_data)
mod1 <- lm(depression ~ anxiety * attention, data = practical5_data)
gvlma(mod1)
mctest(mod1)
### check model summary
summary(mod1)
ps <- plotSlopes(mod1, plotx = "anxiety", modx = "attention", interval = "confidence", modxVals = "std.dev")
ts <- testSlopes(ps)
View(practical5_data)
plot(ts)
practical5_data %>%
ggplot(aes(x = anxiety, y = depression, colour = attention)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Moderated relationship between anxiety and depression by attention") +
theme_minimal()
library(tidyverse)
practical5_data %>%
ggplot(aes(x = anxiety, y = depression, colour = attention)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Moderated relationship between anxiety and depression by attention") +
theme_minimal()
practical5_data %>%
ggplot(aes(x = anxiety, y = depression, colour = attention)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE) +
labs(title = "Moderated relationship between anxiety and depression by attention") +
theme_minimal() +
scale_colour_gradient(low = "red", high = "green")
practical5_data %>%
ggplot(aes(x = anxiety, y = depression, color = attention)) +
geom_point() +
geom_smooth(method = "lm") +
scale_color_gradient(low = "red", high = "green") +
labs(title = "Moderated relationship between anxiety and depression", x = "Anxiety", y = "Depression")
practical5_data %>%
ggplot(aes(x = anxiety, y = depression, color = attention)) +
geom_point() +
geom_smooth(method = "lm") +
geom_smooth(aes(group = attention), method = "lm", linetype = "dashed") +
scale_color_gradient(low = "red", high = "green") +
labs(title = "Moderated relationship between anxiety and depression", x = "Anxiety", y = "Depression")
quarto::quarto_render()
